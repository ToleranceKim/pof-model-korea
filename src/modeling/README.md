# 산불 예측 모델링 문서

## 모델 개요

- **목적**: 기상 데이터를 사용하여 산불 발생 가능성 예측
- **알고리즘**: XGBoost(Extreme Gradient Boosting)
- **입력 변수**: 기온(t2m), 이슬점 온도(td2m), 강수량(tp), 풍속(wind10m)

## 설치 방법

### 의존성 패키지 설치

이 프로젝트는 특정 버전의 라이브러리에 의존하고 있습니다. 다음 명령어로 필요한 패키지를 설치하세요:

```bash
pip install -r requirements.txt
```

특히, XGBoost 1.7.6 버전이 필요합니다. 이는 3.0.0 이상 버전에서 API 호환성 문제가 있기 때문입니다.

### 환경 설정

모델 실행을 위해 다음 디렉토리 구조가 필요합니다:

- `outputs/data/`: 전처리된 기상 데이터 파일 위치
- `outputs/models/`: 학습된 모델과 시각화 결과가 저장되는 위치

## 데이터 특성

### 데이터 불균형 문제

현재 데이터셋은 극심한 클래스 불균형 문제가 있습니다:

- 전체 데이터: 74,844건
- 산불 발생 데이터: 296건(0.3955%)
- 학습 데이터 불균형 비율: 약 251:1 (scale_pos_weight: 251.64)

이러한 불균형은 모델이 희소한 산불 발생 클래스를 학습하는 데 어려움을 줍니다.

## 현재 모델 성능

### 성능 지표

- **ROC AUC**: 0.9178 (높음)
- **정밀도(Precision)**: 0.03 (산불 클래스)
- **재현율(Recall)**: 0.75 (산불 클래스)
- **F1 점수**: 0.05 (산불 클래스)

### 성능 분석

- 높은 ROC AUC 점수는 모델이 두 클래스를 대체로 잘 구분한다는 것을 의미하지만, 실제 활용 측면에서는 한계가 있습니다.
- 낮은 정밀도(0.03)는 모델이 "산불이 발생한다"고 예측할 때 실제로 맞는 경우가 약 3%에 불과하다는 의미로, 오경보율이 매우 높습니다.
- 비교적 높은 재현율(0.75)은 실제 산불의 75%를 감지할 수 있다는 의미지만, 오경보가 너무 많아 실용성이 제한됩니다.
- 이러한 결과는 `scale_pos_weight` 파라미터(251.64)를 통해 희소 클래스에 높은 가중치를 부여했기 때문입니다.

### 특성 중요도

- t2m (기온): 0.3429
- td2m (이슬점 온도): 0.3443
- tp (강수량): 0.1613
- wind10m (풍속): 0.1514

이슬점 온도와 기온이 모델에서 가장 중요한 변수로 나타났습니다.

## XGBoost 버전 호환성 이슈

### 문제점

- XGBoost 3.0.0 버전에서는 이전 버전과 API 호환성 문제가 발생합니다.
- 특히 `eval_metric`, `early_stopping_rounds` 매개변수가 XGBClassifier의 `fit()` 메서드에서 직접 사용할 수 없습니다.
- `callbacks` 매개변수도 sklearn API에서 제대로 지원되지 않는 문제가 있습니다.

### 해결책

- XGBoost 1.7.6 버전으로 다운그레이드하여 기존 코드의 호환성을 유지했습니다.
- 버전 확인: `pip install xgboost==1.7.6`

## 향후 개선 방향

### 모델 성능 개선

1. **데이터 확보**: 더 많은 산불 발생 데이터 수집
2. **샘플링 기법**: SMOTE와 같은 오버샘플링 기법 적용 검토
3. **임계값 조정**: 예측 확률의 임계값을 조정하여 정밀도와 재현율의 균형 개선
4. **앙상블 기법**: 다양한 모델을 결합하여 성능 향상

### 평가 방법 개선

1. **교차 검증**: 시간 기반 교차 검증을 통한 더 견고한 평가
2. **비용 가중 평가**: 오탐지와 미탐지의 비용을 고려한 평가 지표 도입

### 실용적 배포

1. **정밀도-재현율 트레이드오프**: 운영 환경에 맞는 최적의 임계값 설정
2. **단계별 경보 시스템**: 예측 확률을 여러 단계로 나누어 경보 수준 설정

## 사용법

### 기본 모델 훈련

```bash
python run_modeling.py
```

### Optuna 하이퍼파라미터 튜닝 실행

```bash
python src/modeling/train_model_optuna.py
```

### 모델 평가

모델 평가 결과는 훈련 과정에서 출력되며, 혼동 행렬과 분류 보고서를 통해 성능을 확인할 수 있습니다.
